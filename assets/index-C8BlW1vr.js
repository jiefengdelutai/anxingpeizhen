import{_ as L,u as O,r as V,a as p,o as $,m as A,b as G,d as J,c as w,e as y,f as z,g as o,h as K,w as l,i as _,t as C,j as c,F as N,k as Q,l as W,n as X,E as Z,p as ee,q as te,s as oe,v as ae}from"./index-DC1_nRw7.js";import{E as le,a as ne,b as se,c as ie,d as re,e as de}from"./index-BcRYV9xV.js";import{E as me}from"./index-CP5cUftP.js";const ue={class:"flex-box"},pe={style:{"margin-left":"10px"}},_e={class:"pagination-info"},ce={class:"dialog-footer"},fe={__name:"index",setup(ge){const S=O(),d=V(!1),h=()=>{d.value=!1,f.value.resetFields()},f=V(),s=p({name:"",permissions_id:""}),F=async a=>{a&&await a.validate((e,i)=>{if(e){const{name:n,permissions_id:b}=s;X({name:n,permissions_id:b}).then(({data:v})=>{v.code===1e4&&(d.value=!1,u())})}else console.log("error submit",i)})},r=p({pageNum:1,pageSize:10}),m=p({list:[],total:0});$(()=>{u(),A().then(({data:a})=>{g.value=a.data})});const g=V([]),U=a=>{const e=g.value.find(i=>i.id===a);return e?e.name:"超级管理员"},B=a=>{d.value=!0,Object.assign(s,{mobile:a.mobile,name:a.name,permissions_id:a.permissions_id})},u=()=>{G(r).then(({data:a})=>{const{list:e,total:i}=a.data;e.forEach(n=>{n.create_time=J(n.create_time).format("YYYY-MM-DD")}),m.list=e,m.total=i})},D=p({name:[{required:!0,trigger:"blur",message:"请填写昵称"}],permissions_id:[{required:!0,trigger:"blur",message:"请选择菜单权限"}]}),I=a=>{r.pageSize=a,u()},P=a=>{r.pageNum=a,u()};return(a,e)=>{const i=w("PanelHead"),n=le,b=ne,v=w("Clock"),T=Z,x=ee,Y=se,j=ie,k=te,E=oe,q=re,M=de,R=ae,H=me;return y(),z(N,null,[o(i,{route:K(S)},null,8,["route"]),o(Y,{data:m.list,style:{width:"100%"}},{default:l(()=>[o(n,{prop:"id",label:"id"}),o(n,{prop:"name",label:"昵称"}),o(n,{prop:"permissions_id",label:"所属组别"},{default:l(t=>[_(C(U(t.row.permissions_id)),1)]),_:1}),o(n,{prop:"mobile",label:"手机号"}),o(n,{prop:"active",label:"状态"},{default:l(t=>[o(b,{type:t.row.active?"success":"danger"},{default:l(()=>[_(C(t.row.active?"正常":"失效"),1)]),_:2},1032,["type"])]),_:1}),o(n,{label:"创建时间"},{default:l(t=>[c("div",ue,[o(T,null,{default:l(()=>[o(v)]),_:1}),c("span",pe,C(t.row.create_time),1)])]),_:1}),o(n,{label:"操作"},{default:l(t=>[o(x,{type:"primary",onClick:be=>B(t.row)},{default:l(()=>e[6]||(e[6]=[_("编辑")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),c("div",_e,[o(j,{"current-page":r.pageNum,"onUpdate:currentPage":e[0]||(e[0]=t=>r.pageNum=t),"page-size":r.pageSize,background:!1,size:"small",layout:"total, prev, pager, next",total:m.total,onSizeChange:I,onCurrentChange:P},null,8,["current-page","page-size","total"])]),o(H,{modelValue:d.value,"onUpdate:modelValue":e[5]||(e[5]=t=>d.value=t),"before-close":h,title:"添加权限",width:"500"},{footer:l(()=>[c("div",ce,[o(x,{type:"primary",onClick:e[4]||(e[4]=t=>F(f.value))},{default:l(()=>e[7]||(e[7]=[_("确认")])),_:1})])]),default:l(()=>[o(R,{ref_key:"formRef",ref:f,"label-width":"100px","label-position":"left",model:s,rules:D},{default:l(()=>[o(E,{label:"手机号",prop:"mobile"},{default:l(()=>[o(k,{modelValue:s.mobile,"onUpdate:modelValue":e[1]||(e[1]=t=>s.mobile=t),disabled:""},null,8,["modelValue"])]),_:1}),o(E,{label:"昵称",prop:"name"},{default:l(()=>[o(k,{modelValue:s.name,"onUpdate:modelValue":e[2]||(e[2]=t=>s.name=t)},null,8,["modelValue"])]),_:1}),o(E,{label:"菜单权限",prop:"permissions_id"},{default:l(()=>[o(M,{modelValue:s.permissions_id,"onUpdate:modelValue":e[3]||(e[3]=t=>s.permissions_id=t),placeholder:"请选择菜单权限",style:{width:"240px"}},{default:l(()=>[(y(!0),z(N,null,Q(g.value,t=>(y(),W(q,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])],64)}}},ye=L(fe,[["__scopeId","data-v-807e8007"]]);export{ye as default};
